/*! Javascript v0.0.1 CAR.com (c)2014 - Team:http://www.car.com/humans.txt */!function e(a,r,s){function l(i,n){if(!r[i]){if(!a[i]){var o="function"==typeof require&&require;if(!n&&o)return o(i,!0);if(t)return t(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=r[i]={exports:{}};a[i][0].call(c.exports,function(e){var r=a[i][1][e];return l(r?r:e)},c,c.exports,e,a,r,s)}return r[i].exports}for(var t="function"==typeof require&&require,i=0;i<s.length;i++)l(s[i]);return l}({1:[function(e,a,r){!function(a,r,s){var l=s.UTILS.hasSessionStorage;r(function(){var t=s.ENV,i=(t.getJsFileNameByAlias,t.libsPath,r("body")),n=e("./leaseorpurchase_tmpls/desk/tmpls.js"),o=r("#add_change_car_overlay_js"),c="",u="",p="",d="",m="",h="",v="",_="",f="",b="",g="",P="",y="",O="",S={init:function(){if(r("#resultdiv_js").css("display","none"),r("#calc_form_div_js").css("display","block"),r("#btnCalculateLeaseOrPurchase").on("click",function(e){e.preventDefault(),S.calculateLeaseOrPurchase()}),r("#LeaseOrPurchase_purchasePrice").on("click",function(e){r("#LeaseOrPurchase_purchasePrice").val(""),r("#js_selected_trim_label").html(""),h="",f=""}),r("#js_add_compare_car").on("click",function(e){e.preventDefault(),o.popup("show")}),l){var e=JSON.parse(a.sessionStorage.getItem("jsCalcLeaseOrPurchase"));null!==e&&(r("#LeaseOrPurchase_downPayment").val(e.downPayment),r("#LeaseOrPurchase_termMonths").val(e.termMonths),r("#LeaseOrPurchase_loanRate").val(e.loanRate),r("#LeaseOrPurchase_residualValue").val(e.residualValue),r("#LeaseOrPurchase_leasePayment").val(e.leasePayment),r("#LeaseOrPurchase_leaseFee").val(e.leaseFee),r("#LeaseOrPurchase_purchasePrice").val(e.purchasePrice),r("#LeaseOrPurchase_rebate").val(e.rebate),h=e.trimid,f=e.trimlabel)}f.length>0&&r("#js_selected_trim_label").html(f)},calculateLeaseOrPurchase:function(){var e,s=r("#LeaseOrPurchase_downPayment").val().replace(/[^0-9.]+/g,""),t=r("#LeaseOrPurchase_termMonths").val().replace(/[^0-9.]+/g,""),i=r("#LeaseOrPurchase_loanRate").val().replace(/[^0-9.]+/g,""),n=r("#LeaseOrPurchase_residualValue").val().replace(/[^0-9.]+/g,""),o=r("#LeaseOrPurchase_leasePayment").val().replace(/[^0-9.]+/g,""),c=r("#LeaseOrPurchase_leaseFee").val().replace(/[^0-9.]+/g,""),u=r("#LeaseOrPurchase_purchasePrice").val().replace(/[^0-9.]+/g,""),p=r("#LeaseOrPurchase_rebate").val().replace(/[^0-9.]+/g,""),d=Number(o)*Number(t)+Number(c)+Number(s),m=Number(s)+Number(p),v=Number(u)-Number(m),_=(Number(v)+Number(v)*Number(i)/100)/Number(t),b=Number(_)*Number(t)+Number(s)-Number(n);if(isNaN(d)||isNaN(b))e="Please check your entries... Only numbers allowed!";else if(Number(t)<1)e="Term of loan must be at least 1 month";else if(Number(b)>Number(d)){var g=Number(b)-Number(d);e="LEASE! You'll save $"+Math.round(g)+"!"}else{var P=Number(d)-Number(b);e="PURCHASE! You'll save $"+Math.round(P)+"!"}r("#LeaseOrPurchase_decision").text(e),r("#resultdiv_js").css("display","block"),r("#calc_form_div_js").css("display","none"),l&&a.sessionStorage.setItem("jsCalcLeaseOrPurchase",JSON.stringify({downPayment:s,termMonths:t,loanRate:i,residualValue:n,leasePayment:o,leaseFee:c,purchasePrice:u,rebate:p,trimid:h,trimlabel:f})),5===h.length?S.showSimilarVehicles(h):S.showSimilarVehiclesByPrice(u)},showSimilarVehicles:function(e){var a="/api/research/similarvehicles/",s="{trimid: '"+e+"'}",l="";r.post(a,{"":s}).done(function(e){l=e.data,null===l||l.length<1||(r("#js_similar_vehicles_content").empty().prepend(n.similar_vehicles({trimlist:l})),r("#js_similar_vehicles").show())})},showSimilarVehiclesByPrice:function(e){var a="/api/research/similarvehiclesbyprice/",s="{price: '"+e+"'}",l="";r.post(a,{"":s}).done(function(e){l=e.data,null===l||l.length<1||(r("#js_similar_vehicles_content").empty().prepend(n.similar_vehicles({trimlist:l})),r("#js_similar_vehicles").show())})},initAddChangeOverlay:function(){return r.when(r.get("/api/compare/makes/").done(function(e){e.data&&i.append(n.add_change_car_overlay({makeArr:e.data}))})).then(function(){o=r("#add_change_car_overlay_js"),O=r(".overlay-close"),O.on("click",function(e){e.preventDefault(),o.popup("hide")}),c=r("#leaseOrPurchaseModelSelect"),u=r("#leaseOrPurchaseTrimSelect"),r("#leaseOrPurchaseMakeSelect").on("change",function(e){p=r("#leaseOrPurchaseMakeSelect :selected").val(),p.length>0?S.updateCompareModelDropdown():(c.empty().prepend('<option value="">Select a Model</option>').prop("disabled",!0),u.empty().prepend('<option value="">Select a Vehicle</option>').prop("disabled",!0))}),c.on("change",function(e){d=r("#leaseOrPurchaseModelSelect :selected").val(),d.length>0?S.updateCompareTrimDropdown():u.empty().prepend('<option value="">Select a Vehicle</option>').prop("disabled",!0)}),u.on("change",function(e){m=r("#leaseOrPurchaseTrimSelect :selected").text(),b=r("#leaseOrPurchaseTrimSelect :selected").val(),h=b.split("|")[1],g=b.split("|")[0],_=m.substring(0,4),v=m.substring(5),P=p.charAt(0).toUpperCase()+p.substring(1),y=d.charAt(0).toUpperCase()+d.substring(1),f=_+" "+P+" "+y+" "+v,g.length>0&&(r("#LeaseOrPurchase_purchasePrice").val(g),r("#js_selected_trim_label").html(f),o.popup("hide"))})}),!0},updateCompareModelDropdown:function(){var e="/api/compare/make/"+p+"/super-models/";r.when(r.get(e).done(function(e){e.data&&(c.empty().prepend(n.model_select_options({modelArr:e.data})).prop("disabled",!1),u.empty().prepend('<option value="">Select a Vehicle</option>').prop("disabled",!0))})).then(function(){})},updateCompareTrimDropdown:function(){var e="/api/compare/make/"+p+"/super-model/"+d+"/trims/";r.get(e).done(function(e){e.data&&u.empty().prepend(n.trim_select_options({trimArr:e.data})).prop("disabled",!1)})}};r(function(){S.init(),S.initAddChangeOverlay()})})}(window,jQuery,ABT)},{"./leaseorpurchase_tmpls/desk/tmpls.js":2}],2:[function(e,a,r){a.exports.add_change_car_overlay=function(e){var a='<div id="add_change_car_overlay_js" class="overlay overlay-dk max-450" style="display:none"> <button type="button" class="overlay-close"> <span class="icon"> <svg> <use xlink:href="/assets/svg/global-sprite.svg#i_close"></use> </svg> </span> </button> <div class="dead-middle"> <section class="add-change-car-container" id="" style="display: block"> <form> <h1>Select a Car</h1> <p> <label> <select id="leaseOrPurchaseMakeSelect" class="full"> <option value="">Select a Make</option> ',r=e.makeArr;if(r)for(var s,l=-1,t=r.length-1;t>l;)s=r[l+=1],a+=' <option value="'+s.seo_name+'">'+s.name+"</option> ";return a+=' </select> </label> </p> <p> <label> <select id="leaseOrPurchaseModelSelect" class="full" disabled="disabled"> <option value="">Select a Model</option> </select> </label> </p> <p> <label> <select id="leaseOrPurchaseTrimSelect" class="full" disabled="disabled"> <option value="">Select a Vehicle</option> </select> </label> </p> </form> </section> </div></div>'},a.exports.model_select_options=function(e){var a='<option value="">Select a Model</option>',r=e.modelArr;if(r)for(var s,l=-1,t=r.length-1;t>l;)s=r[l+=1],a+='<option value="'+s.seo_name+'">'+s.name+"</option>";return a},a.exports.similar_vehicles=function(e){var a="",r=e.trimlist;if(r)for(var s,l=-1,t=r.length-1;t>l;)s=r[l+=1],a+=' <div class="sugged-item"> <a href="/'+s.make_seo+"/"+s.super_model_seo+"/"+s.year+"/"+s.trim_seo_name+'/"> <div class="img-container"> ',a+=s.image_path&&s.image_path.length>9?' <img src="'+s.image_path+'" alt="'+s.full_display_name+'"> ':' <img src="/assets/svg/no-image-avail.svg" alt="'+s.full_display_name+'"> ',a+=' </div> <h3 class="sugged-title"> '+s.full_display_name+"<br /> <small>Starting at</small><br /> "+s.starting_msrp+" </h3> </a> </div>";return a},a.exports.trim_select_options=function(e){var a='<option value="">Select a Vehicle</option>',r=e.trimArr;if(r)for(var s,l=-1,t=r.length-1;t>l;)s=r[l+=1],a+='<option value="'+s.msrp+"|"+s.id+'">'+s.year+" "+s.name+"</option>";return a}},{}]},{},[1]);