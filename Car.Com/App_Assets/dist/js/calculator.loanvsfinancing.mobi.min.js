/*! Javascript v0.0.1 CAR.com (c)2014 - Team:http://www.car.com/humans.txt */!function e(a,n,i){function t(s,r){if(!n[s]){if(!a[s]){var o="function"==typeof require&&require;if(!r&&o)return o(s,!0);if(l)return l(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};a[s][0].call(c.exports,function(e){var n=a[s][1][e];return t(n?n:e)},c,c.exports,e,a,n,i)}return n[s].exports}for(var l="function"==typeof require&&require,s=0;s<i.length;s++)t(i[s]);return t}({1:[function(e,a,n){!function(a,n,i){var t=i.UTILS.hasSessionStorage;n(function(){var l=i.ENV,s=(l.getJsFileNameByAlias,l.libsPath,n("body")),r=e("./loanvsfinancing_tmpls/desk/tmpls.js"),o=n("#add_change_car_overlay_js"),c="",p="",d="",m="",u="",g="",_="",v="",b="",h="",f="",y="",V="",S="",F={init:function(){if(n("#resultdiv_js").css("display","none"),n("#calc_form_div_js").css("display","block"),n("#btnCalculateRebateVsFinancing").on("click",function(e){e.preventDefault(),F.calculateRebateVsFinancing()}),n("#RebateVsFinancing_salesPrice").on("click",function(e){n("#RebateVsFinancing_salesPrice").val(""),n("#js_selected_trim_label").html(""),g="",b=""}),n("#js_add_compare_car").on("click",function(e){e.preventDefault(),o.popup("show")}),t){var e=JSON.parse(a.sessionStorage.getItem("jsCalcLoanVsFinancing"));null!==e&&(n("#RebateVsFinancing_salesPrice").val(e.salesPrice),n("#RebateVsFinancing_rebate").val(e.rebate),n("#RebateVsFinancing_interestRate").val(e.interestRate),n("#RebateVsFinancing_termYears").val(e.termYears),g=e.trimid,b=e.trimlabel)}b.length>0&&n("#js_selected_trim_label").html(b)},calculateRebateVsFinancing:function(){var e,i=n("#RebateVsFinancing_salesPrice").val().replace(/[^0-9.]+/g,""),l=n("#RebateVsFinancing_rebate").val().replace(/[^0-9.]+/g,""),s=n("#RebateVsFinancing_interestRate").val().replace(/[^0-9.]+/g,""),r=n("#RebateVsFinancing_termYears").val().replace(/[^0-9.]+/g,""),o=Number(i)-Number(l),c=Number(o)*Number(s)/100,p=Number(o)+Number(c);e=isNaN(p)?"Please check your entries... Only numbers allowed!":Number(l)<1?"Please enter a rebate amount...":Number(p)>Number(i)?"Take the 0% financing!":"Take the rebate!",n("#RebateVsFinancing_decision").text(e),n("#resultdiv_js").css("display","block"),n("#calc_form_div_js").css("display","none"),t&&a.sessionStorage.setItem("jsCalcLoanVsFinancing",JSON.stringify({salesPrice:i,rebate:l,interestRate:s,termYears:r,trimid:g,trimlabel:b})),5===g.length?F.showSimilarVehicles(g):F.showSimilarVehiclesByPrice(i)},showSimilarVehicles:function(e){var a="/api/research/similarvehicles/",i="{trimid: '"+e+"'}",t="";n.post(a,{"":i}).done(function(e){t=e.data,null===t||t.length<1||(n("#js_similar_vehicles_content").empty().prepend(r.similar_vehicles({trimlist:t})),n("#js_similar_vehicles").show())})},showSimilarVehiclesByPrice:function(e){var a="/api/research/similarvehiclesbyprice/",i="{price: '"+e+"'}",t="";n.post(a,{"":i}).done(function(e){t=e.data,null===t||t.length<1||(n("#js_similar_vehicles_content").empty().prepend(r.similar_vehicles({trimlist:t})),n("#js_similar_vehicles").show())})},initAddChangeOverlay:function(){return n.when(n.get("/api/compare/makes/").done(function(e){e.data&&s.append(r.add_change_car_overlay({makeArr:e.data}))})).then(function(){o=n("#add_change_car_overlay_js"),S=n(".overlay-close"),S.on("click",function(e){e.preventDefault(),o.popup("hide")}),c=n("#rebateVsFinancingModelSelect"),p=n("#rebateVsFinancingTrimSelect"),n("#rebateVsFinancingMakeSelect").on("change",function(e){d=n("#rebateVsFinancingMakeSelect :selected").val(),d.length>0?F.updateCompareModelDropdown():(c.empty().prepend('<option value="">Select a Model</option>').prop("disabled",!0),p.empty().prepend('<option value="">Select a Vehicle</option>').prop("disabled",!0))}),c.on("change",function(e){m=n("#rebateVsFinancingModelSelect :selected").val(),m.length>0?F.updateCompareTrimDropdown():p.empty().prepend('<option value="">Select a Vehicle</option>').prop("disabled",!0)}),p.on("change",function(e){u=n("#rebateVsFinancingTrimSelect :selected").text(),h=n("#rebateVsFinancingTrimSelect :selected").val(),g=h.split("|")[1],f=h.split("|")[0],v=u.substring(0,4),_=u.substring(5),y=d.charAt(0).toUpperCase()+d.substring(1),V=m.charAt(0).toUpperCase()+m.substring(1),b=v+" "+y+" "+V+" "+_,f.length>0&&(n("#RebateVsFinancing_salesPrice").val(f),n("#js_selected_trim_label").html(b),o.popup("hide"))})}),!0},updateCompareModelDropdown:function(){var e="/api/compare/make/"+d+"/super-models/";n.when(n.get(e).done(function(e){e.data&&(c.empty().prepend(r.model_select_options({modelArr:e.data})).prop("disabled",!1),p.empty().prepend('<option value="">Select a Vehicle</option>').prop("disabled",!0))})).then(function(){})},updateCompareTrimDropdown:function(){var e="/api/compare/make/"+d+"/super-model/"+m+"/trims/";n.get(e).done(function(e){e.data&&p.empty().prepend(r.trim_select_options({trimArr:e.data})).prop("disabled",!1)})}};n(function(){F.init(),F.initAddChangeOverlay()})})}(window,jQuery,ABT)},{"./loanvsfinancing_tmpls/desk/tmpls.js":2}],2:[function(e,a,n){a.exports.add_change_car_overlay=function(e){var a='<div id="add_change_car_overlay_js" class="overlay overlay-dk max-450" style="display:none"> <button type="button" class="overlay-close"> <span class="icon"> <svg> <use xlink:href="/assets/svg/global-sprite.svg#i_close"></use> </svg> </span> </button> <div class="dead-middle"> <section class="add-change-car-container" id="" style="display: block"> <form> <h1>Select a Car</h1> <p> <label> <select id="rebateVsFinancingMakeSelect" class="full"> <option value="">Select a Make</option> ',n=e.makeArr;if(n)for(var i,t=-1,l=n.length-1;l>t;)i=n[t+=1],a+=' <option value="'+i.seo_name+'">'+i.name+"</option> ";return a+=' </select> </label> </p> <p> <label> <select id="rebateVsFinancingModelSelect" class="full" disabled="disabled"> <option value="">Select a Model</option> </select> </label> </p> <p> <label> <select id="rebateVsFinancingTrimSelect" class="full" disabled="disabled"> <option value="">Select a Vehicle</option> </select> </label> </p> </form> </section> </div></div>'},a.exports.model_select_options=function(e){var a='<option value="">Select a Model</option>',n=e.modelArr;if(n)for(var i,t=-1,l=n.length-1;l>t;)i=n[t+=1],a+='<option value="'+i.seo_name+'">'+i.name+"</option>";return a},a.exports.similar_vehicles=function(e){var a="",n=e.trimlist;if(n)for(var i,t=-1,l=n.length-1;l>t;)i=n[t+=1],a+=' <div class="sugged-item"> <a href="/'+i.make_seo+"/"+i.super_model_seo+"/"+i.year+"/"+i.trim_seo_name+'/"> <div class="img-container"> ',a+=i.image_path&&i.image_path.length>9?' <img src="'+i.image_path+'" alt="'+i.full_display_name+'"> ':' <img src="/assets/svg/no-image-avail.svg" alt="'+i.full_display_name+'"> ',a+=' </div> <h3 class="sugged-title"> '+i.full_display_name+"<br /> <small>Starting at</small><br /> "+i.starting_msrp+" </h3> </a> </div>";return a},a.exports.trim_select_options=function(e){var a='<option value="">Select a Vehicle</option>',n=e.trimArr;if(n)for(var i,t=-1,l=n.length-1;l>t;)i=n[t+=1],a+='<option value="'+i.msrp+"|"+i.id+'">'+i.year+" "+i.name+"</option>";return a}},{}]},{},[1]);